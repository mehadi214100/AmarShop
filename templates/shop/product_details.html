{% extends "base.html" %}
{% block content %}
<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content bg-white padding-y">
<div class="container">

<!-- ============================ ITEM DETAIL ======================== -->
	<div class="row">
		<aside class="col-md-6">
<div class="card">
<article class="gallery-wrap">
  <!-- Big Image -->
  <div class="img-big-wrap mb-3 text-center">
    <div class="border rounded p-2 bg-light">
      <a href="#">
        <img id="mainProductImage" src="{{ product.images.first.image.url }}" class="img-fluid" style="max-height: 400px;">
      </a>
    </div>
  </div>

  <!-- Thumbnails -->
  <div class="thumbs-wrap d-flex flex-wrap gap-2 justify-content-center">
    {% for image in product.images.all %}
      <a href="#" class="item-thumb border rounded">
        <img src="{{ image.image.url }}" class="img-thumbnail thumb-img" style="width: 60px; height: 60px; object-fit: cover;">
      </a>
    {% endfor %}
  </div>
</article>



</div> <!-- card.// -->
		</aside>
		<main class="col-md-6">
<article class="product-info-aside">

<h2 class="title mt-3">{{product.name}} </h2>


<div class="mb-3 mt-5"> 
    {% if product.discounted_price < product.price %}
        <var class="price h4">BDT {{ product.discounted_price|floatformat:2 }}</var> 
        <span class="text-muted text-decoration-line-through">BDT {{ product.price|floatformat:2 }}</span>
    {% else %}
        <var class="price h4">BDT {{ product.price|floatformat:2 }}</var> 
    {% endif %}
</div>


<p>{{product.description}} </p>


<dl class="row">


  <dt class="col-sm-3">Availabilty</dt>
  {% if product.stock > 0 %}
  <dd class="col-sm-9 text-success">{{product.stock}} in Stock</dd>
  {% else %}
  <dd class="col-sm-9 text-danger">Stock Out</dd>
  {% endif %}
</dl>

	<div class="form-row  mt-4">

		<div class="form-group col-md">
			
        {% if user.is_authenticated %}
          {% if product.stock > 0 %}
            <a href="{% url "add_cart" product.id %}"  class="btn  btn-secondary border-0">
                <i class="fas fa-shopping-cart"></i> <span class="text">Add to cart</span> 
            </a>
          {% else %}
            <button  class="btn  btn-secondary border-0 " disabled>
                <i class="fas fa-shopping-cart"></i> <span class="text">Add to cart</span> 
            </button>
          {% endif %}
        {% else %}
          <a href="{% url "user_login" %}"  class="btn  btn-secondary border-0">
           <i class="fas fa-shopping-cart"></i> <span class="text">Login to Buy</span> 
          </a>
        {% endif %}
				
			

		</div> <!-- col.// -->
	</div> <!-- row.// -->

</article> <!-- product-info-aside .// -->
		</main> <!-- col.// -->
	</div> <!-- row.// -->

<!-- ================ ITEM DETAIL END .// ================= -->


</div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

<!-- ========================= SECTION  ========================= -->
<section class="section-name padding-y bg">
<div class="container">

<div class="row">
	<div class="col-md-8">
		
        {{product.specification|safe}}
	</div> <!-- col.// -->
	
	<aside class="col-md-4">

		<div class="box">
		

		<h6 class="bg-blue text-center text-white mb-0 p-2">Related Product</h6>
			{% for product in related_products %}
			<div class="card-banner border-bottom">
			  <div class="py-3" style="width:80%">
			    <h6 class="card-title">{{product.name}}</h6>
			    <a href="{% url "product_details" product.slug %}" class="btn btn-blue btn-sm border-0 mt-3"> Buy Now  </a>
			  </div> 
			  <img src="{{product.images.first.image.url}}" height="80" class="img-bg">
			</div>
			{% endfor %}
    
      

		
	</div> <!-- box.// -->
	</aside> <!-- col.// -->
</div> <!-- row.// -->

</div> <!-- container .//  -->
</section>





<script>
  document.addEventListener("DOMContentLoaded", function () {
    const mainImage = document.getElementById("mainProductImage");
    document.querySelectorAll(".thumb-img").forEach(function (thumb) {
      thumb.addEventListener("click", function (e) {
        e.preventDefault();
        mainImage.src = this.src;
      });
    });
  });
</script>


{% endblock content %}